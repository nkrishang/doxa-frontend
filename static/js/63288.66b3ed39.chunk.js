"use strict";(self.webpackChunkdoxa_frontend=self.webpackChunkdoxa_frontend||[]).push([[63288,21299],{17749:(e,t,n)=>{async function a(e,t){return await e({method:"eth_sendRawTransaction",params:[t]})}n.d(t,{B:()=>a})},63288:(e,t,n)=>{n.d(t,{f:()=>I,sendEip712Transaction:()=>B,a:()=>w});var a=n(37131),r=n(77378),s=n(17749),i=n(72364),o=n(3340);function c(e){if(["string","number"].includes(typeof e)&&!Number.isInteger(Number(e)))throw new Error(`Expected value to be an integer to convert to a bigint, got ${e} of type ${typeof e}`);return e instanceof Uint8Array?BigInt((0,o.EY)(e)):BigInt(e)}var u=n(21299),y=n(46325),p=n(79002),g=n(77300),h=n(17143),d=n(11907);const m=32n*n(89492).Au;var l=n(21627);class f extends l.C{constructor(e){let{givenLength:t,maxBytecodeSize:n}=e;super(`Bytecode cannot be longer than ${n} bytes. Given length: ${t}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class x extends l.C{constructor(e){let{givenLengthInWords:t}=e;super(`Bytecode length in 32-byte words must be odd. Given length in words: ${t}`,{name:"BytecodeLengthInWordsMustBeOddError"})}}class P extends l.C{constructor(e){let{givenLength:t}=e;super(`The bytecode length in bytes must be divisible by 32. Given length: ${t}`,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}const b=50000n,v=e=>{const t=function(e){const{gas:t,nonce:n,to:r,from:s,value:i,maxFeePerGas:c,maxPriorityFeePerGas:u,paymaster:y,paymasterInput:p,gasPerPubdata:g,data:l,factoryDeps:v}=e;return{txType:113n,from:BigInt(s),to:r?BigInt(r):0n,gasLimit:t??0n,gasPerPubdataByteLimit:g??b,maxFeePerGas:c??0n,maxPriorityFeePerGas:u??0n,paymaster:y?BigInt(y):0n,nonce:n?BigInt(n):0n,value:i??0n,data:l||"0x0",factoryDeps:v?.map((e=>(0,o.nj)(function(e){const t=(0,a.ZJ)(e);if(t.length%32!==0)throw new P({givenLength:t.length});if(t.length>m)throw new f({givenLength:t.length,maxBytecodeSize:m});const n=(0,d.s)(t),r=(0,a.ZJ)(n),s=t.length/32;if(s%2===0)throw new x({givenLengthInWords:s});const i=(0,a.ZJ)(s),o=(0,h.eV)(i,{size:2}),c=new Uint8Array([1,0]);return r.set(c,0),r.set(o,2),r}(e))))??[],paymasterInput:p||"0x"}}(e);return{domain:{name:"zkSync",version:"2",chainId:e.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:t}};async function B(e){const{account:t,transaction:n}=e,a=await I(e),r=await w({account:t,eip712Transaction:a,chainId:n.chain.id}),o=(0,i.getRpcClient)(n);return{transactionHash:await(0,s.B)(o,r),chain:n.chain,client:n.client}}async function w(e){const{account:t,eip712Transaction:n,chainId:a}=e,s=v(n),i=await t.signTypedData({...s});return function(e){const{chainId:t,gas:n,nonce:a,to:s,from:i,value:c,maxFeePerGas:y,maxPriorityFeePerGas:p,customSignature:g,factoryDeps:h,paymaster:d,paymasterInput:m,gasPerPubdata:l,data:f}=e,x=[a?(0,o.nj)(a):"0x",p?(0,o.nj)(p):"0x",y?(0,o.nj)(y):"0x",n?(0,o.nj)(n):"0x",s??"0x",c?(0,o.nj)(c):"0x",f??"0x0",(0,o.nj)(t),(0,o.nj)(""),(0,o.nj)(""),(0,o.nj)(t),i??"0x",l?(0,o.nj)(l):(0,o.nj)(b),h??[],g??"0x",d&&m?[d,m]:[]];return(0,u.concatHex)(["0x71",(0,r.EQ)(x)])}({...n,chainId:a,customSignature:i})}async function I(e){const{account:t,transaction:n}=e;let[r,s,u,h,d,m,l]=await Promise.all([(0,p.encode)(n),(0,y.r)(n.to),(0,y.r)(n.value),(0,y.r)(n.gas),(0,y.r)(n.maxFeePerGas),(0,y.r)(n.maxPriorityFeePerGas),(0,y.r)(n.eip712)]),f=l?.gasPerPubdata;if(!h||!d||!m){const e=(0,i.getRpcClient)(n),y=await e({method:"zks_estimateFee",params:[{from:t.address,to:s,data:r,value:u?(0,o.cK)(u):void 0,gasPerPubdata:f,eip712Meta:{...l,gasPerPubdata:f?(0,o.nj)(f):(0,o.nj)(50000n),factoryDeps:l?.factoryDeps?.map((e=>Array.from((0,a.aT)(e))))},type:"0x71"}]});h=2n*c(y.gas_limit);d=2n*c(y.max_fee_per_gas),m=c(y.max_priority_fee_per_gas)||1n,f=2n*c(y.gas_per_pubdata_limit),f<50000n&&(f=50000n)}return{...await(0,g.$)({transaction:{...n,gas:h,maxFeePerGas:d,maxPriorityFeePerGas:m},from:t.address}),...n.eip712,gasPerPubdata:f,from:t.address}}},21299:(e,t,n)=>{function a(e){return`0x${e.reduce(((e,t)=>e+t.replace("0x","")),"")}`}n.r(t),n.d(t,{concatHex:()=>a})},89492:(e,t,n)=>{n.d(t,{Ao:()=>s,Au:()=>a,EA:()=>r});const a=65535n,r=2n**96n-1n,s=2n**256n-1n},77378:(e,t,n)=>{n.d(t,{EQ:()=>o});var a=n(21627),r=n(30751),s=n(37131),i=n(84117);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex";const n=c(e),a=(0,r.l)(new Uint8Array(n.length));return n.encode(a),"hex"===t?(0,i.My)(a.bytes):a.bytes}function c(e){return Array.isArray(e)?function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=u(t);return{length:t<=55?1+t:1+n+t,encode(a){t<=55?a.pushByte(192+t):(a.pushByte(247+n),1===n?a.pushUint8(t):2===n?a.pushUint16(t):3===n?a.pushUint24(t):a.pushUint32(t));for(const{encode:t}of e)t(a)}}}(e.map((e=>c(e)))):function(e){const t="string"===typeof e?(0,s.aT)(e):e,n=u(t.length),a=1===t.length&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length;return{length:a,encode(e){1===t.length&&t[0]<128?e.pushBytes(t):t.length<=55?(e.pushByte(128+t.length),e.pushBytes(t)):(e.pushByte(183+n),1===n?e.pushUint8(t.length):2===n?e.pushUint16(t.length):3===n?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t))}}}(e)}function u(e){if(e<256)return 1;if(e<65536)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new a.C("Length is too large.")}},11907:(e,t,n)=>{n.d(t,{s:()=>o});var a=n(98780),r=n(31499),s=n(37131),i=n(84117);function o(e,t){const n=t||"hex",o=(0,a.sc)((0,r.q)(e,{strict:!1})?(0,s.ZJ)(e):e);return"bytes"===n?o:(0,i.nj)(o)}}}]);
//# sourceMappingURL=63288.66b3ed39.chunk.js.map